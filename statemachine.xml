<!--xsltproc statemachine.xsl statemachine.xml | sed '/^[[:space:]]*$/d'| indent-->

<?xml-stylesheet href="statemachine.xsl" ?>
<namespace name="Yggdrasil">
	<statemachine name="Parser">
		<inputvar name="ch_in" type="char" />
		<statevar name="buffer" type="std::string" />
		<statevar name="object" type="DataStore::Compound" />
		<statevar name="valtype" type="std::string" />
		<state name="INIT">
			<case input="'{'" next="KEY">buffer.clear();
			if(buffer!="obj")
				{throw "Root level must be an object";}</case>
			<default>buffer+=ch_in;</default>
		</state>
		<state name="KEY">
			<case input="':'" next="TYPE">valtype=std::move(buffer);</case>
			<case input="'\\'" next="ESCAPE" save-state="true" />
			<default>
				<transition next="WHITESPACE" exclusive="true">if(ch_in<ge/>'\0' <and/> ch_in<le/>' ')
				</transition>
				buffer+=ch_in;
			</default>
		</state>
	</statemachine>
</namespace>
